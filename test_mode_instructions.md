# Инструкция по тестовому режиму Random Coffee

## Описание

Тестовый режим ускоряет временные интервалы для тестирования функционала приложения. В этом режиме один час реального времени эквивалентен пяти рабочим дням (одной рабочей неделе). Это позволяет фокус-группе быстро проверить все функции, связанные с созданием пар, напоминаниями и сбором отзывов.

## Активация и деактивация

### Команды

Тестовый режим доступен только администраторам через скрытые команды:

- `/testmode on` - включить тестовый режим
- `/testmode off` - выключить тестовый режим
- `/testmode` или `/tm` - проверить статус тестового режима

Алиасы команд: `/test_mode`, `/tm`, `/tmode`

### Эффекты активации

При активации тестового режима:

1. Интервалы планировщика автоматически пересчитываются:
   - Создание пар происходит каждые 12 минут (вместо еженедельного)
   - Проверка предстоящих встреч - каждые 2 минуты (вместо ежечасной)
   - Отправка запросов на фидбек - каждые 12 минут (вместо ежедневной)

2. Даты встреч и сроки автоматически пересчитываются с учетом ускорения.

## Использование для тестирования

1. Активируйте тестовый режим командой `/testmode on`
2. Создайте тестовых пользователей с помощью скрипта `test_matching.py`
3. Дождитесь создания пар (должно произойти в течение 12 минут)
4. Проверьте получение напоминаний и запросов на фидбек
5. По завершении тестирования отключите тестовый режим командой `/testmode off`

## Важные замечания

- Во время работы в тестовом режиме все пользователи видят информацию о его активации.
- В тестовом режиме временные интервалы ускорены, но реальные уведомления всё равно отправляются по запланированным в базе данных датам.
- Отключение тестового режима возвращает систему к стандартным интервалам, но запланированные встречи остаются в базе данных с теми же датами.

## Технические детали

Для работы тестового режима были добавлены новые поля в таблицу встреч (meetings):
- `is_cancelled` - флаг отмены встречи
- `feedback_requested` - флаг отправки запроса на фидбек
- `reminder_sent` - флаг отправки напоминания
- переименовано поле `meeting_date` в `scheduled_date`

Для применения этих изменений в базе данных запустите скрипт миграции:
```bash
python run_migration.py
```

## Возможные проблемы

Если встречи не создаются или уведомления не отправляются в тестовом режиме, проверьте:
1. Была ли применена миграция базы данных
2. Используются ли правильные имена полей в коде (scheduled_date вместо meeting_date)
3. Запущен ли бот с правами администратора 